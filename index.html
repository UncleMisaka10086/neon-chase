<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>Neon Chase</title>

<meta name="viewport"
      content="width=device-width, initial-scale=1.0,
               maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="manifest" href="manifest.json">

<style>
html,body { margin:0; padding:0; overflow:hidden; background:#1a0b2e; }
canvas { touch-action: none; }
</style>

<script src="https://cdn.bootcdn.net/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>

<script>
/* ===== 移动端强制设置 ===== */
document.addEventListener('gesturestart', e => e.preventDefault());

if (screen.orientation?.lock) {
  screen.orientation.lock('landscape').catch(()=>{});
}

/* ===== THREE.js 渲染器（手机优化） ===== */
let scene,camera,renderer;

init();
animate();

function init(){
  scene=new THREE.Scene();
  scene.background=new THREE.Color(0x1a0b2e);

  camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,0.1,100);
  camera.position.set(0,6.5,9.5);
  camera.lookAt(0,0,-4);

  renderer=new THREE.WebGLRenderer({
    antialias:false,
    powerPreference:"high-performance"
  });
  renderer.setSize(innerWidth,innerHeight);
  renderer.setPixelRatio(Math.min(devicePixelRatio,1.5));
  document.body.appendChild(renderer.domElement);

  const light=new THREE.DirectionalLight(0xffffff,1);
  light.position.set(10,20,10);
  scene.add(light);

  const floor=new THREE.Mesh(
    new THREE.PlaneGeometry(20,100),
    new THREE.MeshStandardMaterial({color:0x111111})
  );
  floor.rotation.x=-Math.PI/2;
  scene.add(floor);

  const player=new THREE.Mesh(
    new THREE.BoxGeometry(1,2,1),
    new THREE.MeshStandardMaterial({color:0xff0055})
  );
  player.position.y=1;
  scene.add(player);
}

function animate(){
  requestAnimationFrame(animate);
  renderer.render(scene,camera);
}

addEventListener('resize',()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
});

/* ===== PWA 注册 ===== */
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('./sw.js');
}
</script>

</body>
</html>

